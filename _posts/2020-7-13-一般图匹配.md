---
title: 一般图匹配最大匹配
tags:
  - ACM
  - 算法竞赛  
  - 图论
  - 带花树
---

# 一般图匹配 （带花树开花）

说到最大匹配，不可避免的就会想到二分图最大匹配。实际上，一般图最大匹配是在二分图上进行修改得出的。

一般图最大匹配：对于一个图G(V,E)，它的匹配M是二元组(u,v)组成的集合，其中u,v∈V,(u,v)∈E，并且M中不存在重复的点。当|M|最大的时候，我们称M为G的最大匹配。

和二分图进行比对一下：

当图 G(V,E) 是一个二分图时，由于其若含有环，则一定是偶环（一个点数为 2k 的环），其最大匹配可以使用匈牙利算法或网络流算法来求解。

当图 G(V,E) 是一个一般图时，由于一般图可能会含有奇环（一个点数为 2k+1 的环），而经过一个奇环会得到两条含有同一个点的匹配边，因此当图 G(V,E) 是一个一般图时，无法直接进行增广，需要用改进算法来求解最大匹配，即带花树算法。

带花树算法的**求解步骤**有n个阶段，每个阶段从没有匹配的S点开始BFS寻找增广路

BFS开始，首先将S放入队列，并染色为黑，接着寻找下一个能和他匹配的没有染过色的点x，有两种情况：

​		1、如果x点已经有匹配（匹配点为y）了，将其染色为白，而其匹配的点y染色成黑，并x点加入队列继续增广

​		2、如果x点没有匹配，说明我们找到了一条增广路径，然后我们沿着之前搜过来的边找回去，这个就是展开带花树，在搜索回去的过程中如果遇到了环又会有两种情况：

​				a)	遇到偶环，无需在意，不影响结果

​				b)	遇到奇环，那么找到当前