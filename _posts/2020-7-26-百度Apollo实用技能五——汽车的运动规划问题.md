---
title: 百度Apollo使用技能五——汽车的运动规划问题
tags:
  - 百度
  - 无人驾驶
---

# 百度Apollo使用技能五——汽车的运动规划问题

### 一、运动规划

- 运动规划：给定两个位置，要你再两个位置之间找一条最优路径
- 问题本质：搜索问题，给定一个函数寻找最优解
- 涉及领域：
  - 机器人领域：如何产生轨迹和完成目标，迭代A* 算法、D* 算法
  - 控制领域：规划理解为到达目标状态的动态系统
  - 人工智能：是生成状态到动作的映射

### 二、如何构建汽车的运动规划问题

类比路径查找问题：最短路算法

1、A* 算法：相对于BFS和DFS，A* 算法事先得到了起点和终点的位置，花费时间比两类搜索都短

- A-star算法还不能直接用在规划模块上，因为A-star算法本身要求对整个环境全知
- 无人车的传感器系统只能部分观察环境
- 利用D-star算法对部分观察的数据进行控制规划，D-star的特点是处理在看到的有限范围的条件下，如何到达预定地点的搜索问题方法

2、D* 算法

- 利用D-star算法对部分观察的数据进行控制规划，D-star的特点是处理在看到的有限范围的条件下，如何到达预定地点的搜索问题方法
- 这种增量搜索很难通过一步步的迭代达到全局最优解

Tips：

- 直接90度转弯是不合理的，可以通过平滑性曲线的方式来优化折线，换成一些较为平滑的曲线来完成

有几个问题：

- 规划模块怎么处理动态障碍物是关键并且是有难度的
- 自动驾驶汽车能否按照规划的行驶？
- 将交通规则融入规划也是一个难点
- 实时计算：目前来说百度要求规划模块运转周期是100毫秒

### 三、无人驾驶系统软件

运动规划可以获得两部分信息

- 动态信息：从认知获得的信息，就是从感知模块和定位模块获得信息
- 静态信息：高精地图

软件结构：

- 定位、感知、预测、运动规划和控制等

规划的内容：

- 从可见信息中给无人车找到一条轨迹，且它包含两方面信息，一是路径信息，二是速度配置文件，需要保证速度和路径变化都是平滑的

### 四、无人驾驶运动规划

为什么要进行规划决策：

- 自动驾驶车辆的规划决策模块负责生成车辆的行驶行为，是体现车辆智慧水平的关键

- 规划决策模块中的运动规划环节负责生成车辆的局部运动轨迹，是决定车辆行驶质量的直接因素。

规划方法：

- 运动规划基本方法有：RRT、Lattice、Spira、Polynomial、Functional Optimization等

现实情况：

- 现实之中无法像上面的内容一样，把物体看作一个质点，所以需要Configuration Space （构造空间）

规划问题的约束条件：

- 规划问题中涉及到一些约束条件大概分为三类：
  - 一个是Local Constraint，例如避免和障碍物碰撞
  - 第二是Differential Constraint，比如边界曲率
  - 最后是Global Constraint。比如最短路径

### 五、运动规划框架

- 运动规划是在连续空间的一种优化，对于连续空间过程的优化往往比较难，需将连续空间问题离散化表示
- Roadmap：使用简单的连通图表示配置空间，使连续空间离散化
- Visibility Graph将起始节点，所有障碍物的顶点和目标节点相互连接来构建图
- 除了Roadmap之外，还有Cell decomposition（网格分解方法）和Potential field（势场法）等路径规划方法
  - Cell decomposition将整个空间分割成一个个cell，通过cell的连接图表示自由空间的连接属性
  - Potential field就是直接用微分方法处理
- 一种常用的抽象连续空间的方法叫做PRM：
  - 它在整个配置空间随机采样一些点，如果点在障碍物上则去掉，然后将这些点连接起来
  - 最短路径就可以利用A-Star算法进行求解

### 六、运动规划的基本方法

- RRT (基于快速扩展随机树算法)
  - 它构造一个根结点为起始点的配置空间树，通过随机采样增加叶子节点的方式，生成一个随机扩展树，当随机树中的叶子节点包含了目标点或进入了目标区域，便可以在随机树中找到一条由从初始点到目标点的路径
  - 通过这种方式离散化的线是不适合无人车行驶的，因为这些线的curvature不连续，甚至curvature都没有
- Lattice网格方法
  - 最原始的Lattice网格方法非常简单，它在XY世界坐标系中，以1米为单位进行网格划分，然后用无人车可以行进的、曲率连续的曲线将起始点和目标点连接起来
- Polynomial方法
  - 它将问题降维，分成了path 和 speed两个维度逐渐优化，这是一种iterative的处理方式
- Functional Optimization方法
  - 二次规划就是其中一种常用的方法