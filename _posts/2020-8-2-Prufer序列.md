---
title: Prufer序列
tags:
  - ACM
  - 算法竞赛
  - 树
  - 数据结构
  - 图论
---

# Prufer序列

### 定义——摘取自百度

- Prufer数列是无根树的一种数列。在组合数学中，Prufer数列由有一个对于顶点标过号的树转化来的数列，点数为n的树转化来的Prufer数列长度为n-2。它可以通过简单的迭代方法计算出来。它由Heinz Prufer于1918年在证明cayley定理时首次提出。
- **一颗确定的无根树，对应着唯一确定的Prufer序列**

### 构造方法

- 找到编号最小的度数为1的点
- 删除该节点并在序列中添加与该节点相连的节点的编号
- 重复上述两个操作，直到整棵树只剩下两个节点

### 反向构造

- 每次取出prufer序列中最前面的元素u
- 在点集中找到编号最小的没有在prufer序列中出现的元素v
- 给u,v连边然后分别删除
- 最后在点集中剩下两个节点，给它们连边

**Tips：以上两种操作都可以用set维护，时间复杂度O(nlogn)**

### Prufer序列的性质

- prufer序列中某个编号出现的次数就等于这个编号的节点在无根树中的度数-1
- 一棵n个节点的无根树唯一地对应了一个长度为n-2的数列，数列中的每个数都在1到n的范围内。
- n个点的无向完全图的生成树的计数：$n^{n-2}$个，即n个点的有标号无根树的计数
- n个节点的度数依次为d1,d2,d3……,dn的无根树共有$\frac{(n-2)!}{\prod_{i=1}^{n}(di-1)!}$,因为此时Prufer编码中的数字i恰好出现$di-1$次，$(n−2)!$是总排列数。
- n个点的，有编号有根树的计数：$n^{n-2}*n = n^{n-1}$